<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aprende con Douglas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f1f1;
            color: #333;
            background-image: url('https://images.unsplash.com/photo-1549057442-5f6531557007?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
        }
        .header-content {
            background-color: #1a2;
            color: #fff;
            border-bottom-left-radius: 16px;
            border-bottom-right-radius: 16px;
            box-shadow: 0 4px 116px rgba(0, 0, 0, 0.1);
        }
        .footer-content {
            background-color: #1a202c;
            color: #fff;
            border-top-left-radius: 16px;
            border-top-right-radius: 16px;
            box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.1);
        }
        .card {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .module-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .module-card:hover {
            transform: scale(1.03);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
        }
        
        #progress-bar {
            transition: width 0.5s ease-in-out;
        }

        /* Modal */
        .modal {
            background-color: rgba(0, 0, 0, 0.7);
        }
        
        /* Intro Overlay */
        #intro-overlay {
            background-color: rgba(0, 0, 0, 0.5);
            padding: 2rem;
            border-radius: 12px;
        }

        /* Matching Game Styles */
        .card-game {
            width: 120px;
            height: 120px;
            perspective: 1000px;
            cursor: pointer;
            position: relative;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .card-game.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .card-front {
            background-color: #4f46e5;
            color: white;
            transform: rotateY(0deg);
        }

        .card-back {
            background-color: #6366f1;
            color: white;
            transform: rotateY(180deg);
        }
    </style>
</head>
<header class="w-full py-4 text-center header-content mb-8">
    <h1 class="text-3xl sm:text-4xl font-bold">
        <i class="fas fa-graduation-cap mr-3"></i>Aprende con Douglas</h1>
        </div>
        <h2 class="text-2xl sm:text-3xl font-bold">Curso Completo de Inglés Básico</h2>

        <p class="text-sm sm:text-base text-back-400 mt-2">¡Aprende y practica a tu ritmo!</p>
        </div>
    </header>

    <main id="app-container" class="container mx-auto mt-8 p-4">

        <div id="main-menu" class="space-y-8">
            <div id="intro-overlay" class="text-center">
                <h2 class="text-4xl font-bold text-white">¡Te damos la bienvenida!</h2>
                <p class="text-xl text-green-100 mt-2">¡Esperamos que disfrutes de tu experiencia de aprendizaje en esta Aula Virtual!</p>
            </div>
            <div id="module-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                </div>
            
            <div class="flex justify-center mt-8 space-x-4">
                <button id="share-button" class="bg-green-500 text-white py-2 px-4 rounded-full hover:bg-green-600 transition duration-300">
                    <i class="fas fa-share-alt text-sm mr-2"></i> Compartir curso
                </button>
                <div id="admin-button-container">
                    <button id="admin-button" class="bg-blue-500 text-white py-2 px-4 rounded-full hover:bg-blue-600 transition duration-300">
                        <i class="fas fa-lock text-sm mr-2"></i> Admin
                    </button>
                </div>
            </div>
        </div>

        <div id="module-view" class="hidden space-y-6">
            <div class="text-center">
                <button onclick="showMainMenu()" class="bg-gray-200 text-gray-800 py-2 px-4 rounded-full hover:bg-gray-300 transition duration-300 transform hover:scale-105 inline-flex items-center">
                    <i class="fas fa-arrow-left mr-2"></i> Volver a Módulos
                </button>
                <h2 id="module-title" class="text-4xl font-bold mt-4"></h2>
                <p id="module-description" class="text-lg text-gray-600 mt-2"></p>
                <div id="module-media" class="mt-4"></div>
            </div>
            <div id="lesson-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                </div>
        </div>

        <div id="lesson-template" class="hidden lesson-view">
            <div class="space-y-6">
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <button id="back-to-modules-button" class="bg-gray-200 text-gray-800 py-2 px-4 rounded-full hover:bg-gray-300 transition duration-300 transform hover:scale-105 inline-flex items-center mb-4">
                        <i class="fas fa-arrow-left mr-2"></i> Volver al Módulo
                    </button>
                    <h2 id="lesson-title" class="text-3xl font-bold text-gray-800 mb-4"></h2>
                    <div id="lesson-media-container" class="flex flex-wrap items-center gap-4 mb-4"></div>
                    <div id="lesson-content" class="prose max-w-none text-gray-700"></div>
                    <div class="mt-8 text-center">
                        <button id="show-quiz-button" class="bg-blue-500 text-white py-3 px-8 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105">
                            Realizar Cuestionario
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="quiz-template" class="hidden quiz-view">
            <div class="space-y-6">
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <button id="back-to-lesson-button" class="bg-gray-200 text-gray-800 py-2 px-4 rounded-full hover:bg-gray-300 transition duration-300 transform hover:scale-105 inline-flex items-center mb-4">
                        <i class="fas fa-arrow-left mr-2"></i> Volver a la lección
                    </button>
                    <h2 id="quiz-title" class="text-3xl font-bold text-gray-800 mb-4"></h2>
                    <div id="progress-container" class="relative pt-1 mb-4">
                        <div class="flex mb-2 items-center justify-between">
                            <div>
                                <span class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full bg-blue-200 text-blue-600">
                                    Progreso
                                </span>
                            </div>
                            <div class="text-right">
                                <span id="progress-text" class="text-xs font-semibold inline-block text-blue-600">
                                    0/0
                                </span>
                            </div>
                        </div>
                        <div class="overflow-hidden h-2 mb-4 text-xs flex rounded bg-blue-200">
                            <div id="progress-bar" style="width:0%" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-500"></div>
                        </div>
                    </div>
                    <div id="timer-container" class="text-center mb-4">
                        <div id="timer" class="text-xl font-bold text-red-500 mt-2 sm:mt-0">15:00</div>
                    </div>
                    <div id="quiz-questions">
                        </div>
                    <div id="feedback-message" class="mt-4 text-center text-lg font-bold min-h-[1.5rem]"></div>
                    <div id="quiz-results" class="text-center hidden">
                        <h3 class="text-2xl font-bold text-gray-800">Cuestionario Finalizado</h3>
                        <p id="score-text" class="text-xl mt-2"></p>
                        <div class="mt-4">
                            <button onclick="showMainMenu()" class="bg-green-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-green-600 transition duration-300 transform hover:scale-105">
                                Volver al Menú Principal
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="matching-game-template" class="hidden text-center space-y-6">
            <button onclick="showMainMenu()" class="bg-gray-200 text-gray-800 py-2 px-4 rounded-full hover:bg-gray-300 transition duration-300 transform hover:scale-105 inline-flex items-center">
                <i class="fas fa-arrow-left mr-2"></i> Volver a Módulos
            </button>
            <h2 class="text-3xl font-bold text-white drop-shadow-lg">Juego de Memoria</h2>
            <p class="text-white drop-shadow-lg">¡Haz clic en las cartas para encontrar los pares de palabras!</p>
            <div id="card-container" class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 gap-4 justify-center items-center">
                </div>
        </div>

        <div id="blocked-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
            <div class="bg-white p-8 rounded-lg shadow-lg text-center">
                <h3 class="text-2xl font-bold text-red-500 mb-4">Módulo Bloqueado</h3>
                <p class="text-gray-700">Este módulo está actualmente bloqueado. Por favor, completa los módulos anteriores para desbloquearlo.</p>
                <div class="mt-6">
                    <button onclick="hideBlockedMessage()" class="bg-red-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-red-600 transition duration-300">
                        Entendido
                    </button>
                </div>
            </div>
        </div>

        <div id="admin-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
            <div class="bg-white p-8 rounded-lg shadow-lg text-center w-full max-w-md">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">Acceso de Administrador</h3>
                <input type="password" id="admin-password-input" placeholder="Ingresa la contraseña" class="w-full px-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4">
                <button id="unlock-button" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300">
                    Desbloquear
                </button>
                <p id="admin-message" class="hidden"></p>
                <div class="mt-4">
                    <button onclick="hideAdminModal()" class="text-gray-500 hover:text-gray-700">
                        Cancelar
                    </button>
                </div>
            </div>
        </div>
    </main>

    <footer class="w-full py-4 text-center footer-content mt-8">
        <p class="text-gray-400">© 2025 Aprende con Douglas. Todos los derechos reservados. Caracas, Venezuela.</p>
        <p class="mt-2"> Contacto: Prof. Douglas A. García P. 0426-186-7736 email: <a href="mailto:edutic.capital@gmail.com" class="text-blue-400 hover:underline"> edutic.capital@gmail.com</a></p>
        <div class="flex justify-center mt-2 space-x-4 text-gray-800">
    </footer>
    
    <script>
        const FIREBASE_CONFIG = {
            apiKey: "AIzaSyCJEmxWUH2AlIrlNR8mrMmf7_Vwrc8aQnM",
            authDomain: "aprendiendo-con-douglas.firebaseapp.com",
            projectId: "aprendiendo-con-douglas",
            storageBucket: "aprendiendo-con-douglas.firebasestorage.app",
            messagingSenderId: "9000551102",
            appId: "1:9000551102:web:87e7467e5ef4b9ce0614ef"
        };
        firebase.initializeApp(FIREBASE_CONFIG);
        const database = firebase.database();
        
        const modules = {
            'modulo-1-fundamentos-comunicacion': {
                title: 'Módulo 1: Los Fundamentos de la Comunicación',
                description: 'Aprende a comunicarte desde cero con saludos, despedidas y vocabulario esencial.',
                color: 'bg-indigo-600',
                media: {
                    image: 'https://cdn.pixabay.com/photo/2016/09/01/08/25/english-1635056_960_720.jpg', 
                },
                lessons: {
                    'saludos-despedidas': {
                        title: 'Saludos y Despedidas',
                        content: `
                            <h3 class="text-2xl font-semibold">Saludos comunes</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>Hello / Hi:</strong> Hola</li>
                                <li><strong>Good morning:</strong> Buenos días</li>
                                <li><strong>Good afternoon:</strong> Buenas tardes</li>
                                <li><strong>Good evening:</strong> Buenas noches (saludo)</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Despedidas comunes</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>Goodbye / Bye:</strong> Adiós</li>
                                <li><strong>Good night:</strong> Buenas noches (despedida)</li>
                                <li><strong>See you later:</strong> Nos vemos luego</li>
                                <li><strong>Take care:</strong> Cuídate</li>
                            </ul>
                        <a href="https://drive.google.com/uc?export=download&id=1npwlJdfuw7jhpMgyVTcA144qVsBJyzen" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar PDF de Saludos y Despedidas
                                </a>
                                <audio controls class="w-full md:w-1/2">
    <source src="https://archive.org/download/saludos-y-despedidas/Saludos y Despedidas.mp3" type="audio/mpeg">
    Tu navegador no soporta el elemento de audio.
    </audio>                                
    <p class="text-sm mt-2 text-gray-500">Audio: Saludos y Despedidas</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Cuál usarías para despedirte en la noche?', options: ['Good evening', 'Good night', 'Good morning'], answer: 'Good night' },
                            { type: 'true-false', question: '¿"Hi" y "Hello" tienen el mismo significado?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa: "It\'s late, time to say _____."', answer: 'goodbye' },
                            { type: 'multiple-choice', question: 'Si es mediodía, ¿qué saludo es el más adecuado?', options: ['Good morning', 'Good afternoon', 'Good evening'], answer: 'Good afternoon' },
                            { type: 'true-false', question: '¿"Take care" significa "cuídate"?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa: "I am going to the store, _____."', answer: 'see you later' }
                        ]
                    },
                    'pronombres-personales': {
                        title: 'Pronombres Personales (Personal Pronouns)',
                        content: `
                            <h3 class="text-2xl font-semibold">Concepto</h3>
                            <p>Son palabras que reemplazan a los sustantivos para referirse a una persona, animal o cosa.</p>
                            <h3 class="text-2xl font-semibold mt-4">Pronombres</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>I = </strong> yo - Para referirse a uno mismo.</li>
                                <li><strong>You = </strong> tú, usted, ustedes - Para referirse a la persona o personas con las que se habla. </li>
                                <li><strong>He = </strong> él - Para referirse a un hombre o chico. </li>
                                <li><strong>She = </strong> ella - Para referirse a una mujer o chica. </li>
                                <li><strong>It = </strong> eso - Para referirse a objetos, animales o situaciones, o en general para cosas en singular.</li>
                                <li><strong>We = </strong> nosotros/as - Para referirse a uno mismo y otras personas. </li>
                                <li><strong>They = </strong> ellos/as - Para referirse a un grupo de personas, animales u objetos. </li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1jhGo_egJ2-VJjMBrsTZWKuxGfu-riLyG" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/pronombres_personales_curso/pronombres_personales_curso.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Pronombres Personales</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Cuál es el pronombre para "ella"?', options: ['He', 'She', 'It'], answer: 'She' },
                            { type: 'true-false', question: '¿"You" solo se usa para singular?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "_____ are my friends." (Ellos)', answer: 'They' },
                            { type: 'multiple-choice', question: '¿Qué pronombre usarías para referirte a un perro?', options: ['He', 'It', 'She'], answer: 'It' },
                            { type: 'true-false', question: '¿"We" significa "tú y yo"?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "_____ is a good student." (Él)', answer: 'He' }

                        ]
                    },
                }
            },
            'modulo-2-sustantivos-adjetivos': {
                title: 'Módulo 2: Sustantivos y Adjetivos',
                description: 'Aprende los conceptos más básicos sobre los sustantivos, los adjetivos y los pronombres, el punto de partida perfecto para tu viaje por la gramática inglesa.',
                color: 'bg-red-500',
                lessons: {
                    'adjetivos-posesivos': {
                        title: 'Adjetivos Posesivos (Possessive Adjectives)',
                        content: `
                            <h3 class="text-2xl font-semibold">Concepto</h3>
                            <p>Los adjetivos posesivos indican a quién o a quiénes le pertenece algo. Se usan siempre junto a un sustantivo (noun).</p>
                            <h3 class="text-2xl font-semibold mt-4">Regla principal</h3>
                            <p>Se colocan <strong>antes</strong> del sustantivo que describen.</p>
                            <h3 class="text-2xl font-semibold mt-4">Ejemplos clave</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>My</strong> (mi/mis): <strong>My</strong> name is Ana.</li>
                                <li><strong>Your</strong> (tu/tus): <strong>Your</strong> house is big.</li>
                                <li><strong>His</strong> (su, de él): <strong>His</strong> car is red.</li>
                                <li><strong>Her</strong> (su, de ella): <strong>Her</strong> bag is small.</li>
                                <li><strong>Its</strong> (su, de eso/animal): <strong>Its</strong> tail is long.</li>
                                <li><strong>Our</strong> (nuestro/a): <strong>Our</strong> family is nice.</li>
                                <li><strong>Their</strong> (su, de ellos/as): <strong>Their</strong> dog is cute.</li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1jhGo_egJ2-VJjMBrsTZWKuxGfu-riLyG" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/pronombres_personales_curso/pronombres_personales_curso.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Pronombres Personales</p>
                            </div>
`,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Cuál es el adjetivo posesivo para "I"?', options: ['Your', 'My', 'His'], answer: 'My' },
                            { type: 'true-false', question: '¿Los adjetivos posesivos van después del sustantivo?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "This is _____ book." (You)', answer: 'your' },
                            { type: 'multiple-choice', question: 'Si la dueña es una mujer, ¿qué adjetivo posesivo usarías para referirte a su bolso?', options: ['His', 'Her', 'Our'], answer: 'Her' },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "The dog is wagging _____ tail." (It)', answer: 'its' },
                            { type: 'true-false', question: '¿"Their" se usa para un solo dueño?', answer: false },
                            { type: 'multiple-choice', question: '¿Cuál es el adjetivo posesivo para "We"?', options: ['They', 'Our', 'Your'], answer: 'Our' },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "_____ name is Pedro." (He)', answer: 'His' },
                            { type: 'true-false', question: '¿"My" solo se usa para singular?', answer: false },
                            { type: 'multiple-choice', question: '¿Qué adjetivo posesivo usarías para hablar del auto de tus amigos?', options: ['Our', 'My', 'Their'], answer: 'Their' }
                        ]
                    },
                    'adjetivos': {
                        title: 'Adjetivos (Adjectives)',
                        content: `
                            <h3 class="text-2xl font-semibold">Concepto</h3>
                            <p>Son palabras que describen sustantivos, respondiendo a las preguntas "¿cómo es?" o "¿cómo está?".</p>
                            <h3 class="text-2xl font-semibold mt-4">Reglas y consejos</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>Ubicación:</strong> Los adjetivos siempre van <strong>antes</strong> del sustantivo en inglés (ejemplo: a <strong>red</strong> apple).</li>
                                <li><strong>Plural:</strong> No tienen forma plural. Si el sustantivo es plural, el adjetivo se mantiene igual (ejemplo: two <strong>delicious</strong> cookies).</li>
                                <li><strong>Género:</strong> No tienen género. Se usan de la misma forma para sustantivos masculinos o femeninos (ejemplo: a <strong>good</strong> mom, a <strong>good</strong> dad).</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Ejemplos clave</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>A <strong>red</strong> apple (Una manzana roja)</li>
                                <li>A <strong>happy</strong> boy (Un chico feliz)</li>
                                <li>My cats are <strong>small</strong> (Mis gatos son pequeños)</li>
                            </ul>
                        `,
                        media: {
                            document: [
                        { url: 'https://drive.google.com/uc?export=download&id=1jhGo_egJ2-VJjMBrsTZWKuxGfu-riLyG', name: 'Descargar lección en PDF' }
                    ],
                    audio: { url: 'https://archive.org/download/pronombres_personales_curso/pronombres_personales_curso.mpce', name: 'Escuchar audio'}
                    },
                        quiz: [
                            { type: 'true-false', question: '¿Los adjetivos en inglés se colocan después del sustantivo?', answer: false },
                            { type: 'multiple-choice', question: '¿Qué adjetivo describe a un sustantivo?', options: ['Run', 'Big', 'Quickly'], answer: 'Big' },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "She has a _____ house." (beautiful)', answer: 'beautiful' },
                            { type: 'true-false', question: '¿Los adjetivos tienen género en inglés?', answer: false },
                            { type: 'multiple-choice', question: '¿Cuál de estos es un adjetivo?', options: ['Walk', 'Car', 'Tall'], answer: 'Tall' },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "The _____ children are playing." (happy)', answer: 'happy' },
                            { type: 'true-false', question: '¿Los adjetivos en inglés no tienen forma plural?', answer: true },
                            { type: 'multiple-choice', question: '¿Cómo dirías "libros interesantes"?', options: ['Books interesting', 'Interesting books', 'Books are interesting'], answer: 'Interesting books' },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "The soup is _____." (hot)', answer: 'hot' },
                            { type: 'true-false', question: '¿"Good" es un adjetivo que cambia con el género?', answer: false }
                        ]
                    },
                    'pronombres-demostrativos': {
                        title: 'Pronombres Demostrativos (Demonstrative Pronouns)',
                        content: `
                            <h3 class="text-2xl font-semibold">Concepto</h3>
                            <p>Se utilizan para señalar personas, animales o cosas, e indican si están cerca o lejos.</p>
                            <h3 class="text-2xl font-semibold mt-4">Reglas principales</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>Cerca:</strong> Se usa <strong>this</strong> para singular y <strong>these</strong> para plural.</li>
                                <li><strong>Lejos:</strong> Se usa <strong>that</strong> para singular y <strong>those</strong> para plural.</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Ejemplos clave</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>This</strong> is my pen. (<strong>Este</strong> es mi bolígrafo.)</li>
                                <li><strong>These</strong> are my pens. (<strong>Estos</strong> son mis bolígrafos.)</li>
                                <li><strong>That</strong> is his shoe. (<strong>Ese</strong> es su zapato.)</li>
                                <li><strong>Those</strong> are his shoes. (<strong>Esos</strong> son sus zapatos.)</li>
                            </ul>
                        `,
                        media: {
                            document: [
                        { url: 'https://drive.google.com/uc?export=download&id=1jhGo_egJ2-VJjMBrsTZWKuxGfu-riLyG', name: 'Descargar lección en PDF' }
                    ],
                    audio: { url: 'https://archive.org/download/pronombres_personales_curso/pronombres_personales_curso.mp3', name: 'Escuchar audio'}
                    },
                        quiz: [
                            { type: 'multiple-choice', question: '¿Qué pronombre usarías para señalar un libro que tienes en la mano?', options: ['That', 'These', 'This'], answer: 'This' },
                            { type: 'true-false', question: '¿"Those" se usa para cosas que están lejos y son singulares?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "I love _____ shirt." (cerca, singular)', answer: 'this' },
                            { type: 'multiple-choice', question: '¿Qué pronombre usarías para hablar de los autos que están lejos?', options: ['These', 'That', 'Those'], answer: 'Those' },
                            { type: 'true-false', question: '¿"This" y "These" se usan para referirse a cosas que están cerca?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "_____ are my friends." (cerca, plural)', answer: 'These' },
                            { type: 'multiple-choice', question: '¿Cuál es la forma plural de "That"?', options: ['This', 'Those', 'These'], answer: 'Those' },
                            { type: 'true-false', question: '¿"That" se usa para cosas que están lejos?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "Look at _____ bird over there." (lejos, singular)', answer: 'that' },
                            { type: 'multiple-choice', question: '¿Qué pronombre usarías para hablar de varios libros que están en la mesa de enfrente?', options: ['These', 'Those', 'This'], answer: 'Those' }
                        ]
                    }
                }
            },
            'modulo-3-construccion-oraciones': {
                title: 'Módulo 3: Construcción de Oraciones',
                description: 'Crea oraciones con el verbo "to be", aprende a hacer preguntas y a usar artículos definidos e indefinidos.',
                color: 'bg-green-600',
                media: {
                    image: 'https://cdn.pixabay.com/photo/2017/08/21/11/17/learn-2665992_960_720.jpg',
                },
                lessons: {
                    'verbo-to-be': {
                        title: 'El Verbo "To Be"',
                        content: `
                            <h3 class="text-2xl font-semibold">Concepto</h3>
                            <p>El verbo **"to be"** significa **ser** o **estar**.</p>
                            <h3 class="text-2xl font-semibold mt-4">Conjugación</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>I am:</strong> Yo soy / Yo estoy</li>
                                <li><strong>You are:</strong> Tú eres / Tú estás</li>
                                <li><strong>He/She/It is:</strong> Él/Ella/Eso es / Él/Ella/Eso está</li>
                                <li><strong>We are:</strong> Nosotros/as somos / Nosotros/as estamos</li>
                                <li><strong>They are:</strong> Ellos/as son / Ellos/as están</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Ejemplos clave</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>I am</strong> a student. (Yo soy un estudiante.)</li>
                                <li><strong>She is</strong> happy. (Ella está feliz.)</li>
                                <li><strong>They are</strong> at home. (Ellos están en casa.)</li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1jhGo_egJ2-VJjMBrsTZWKuxGfu-riLyG" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/pronombres_personales_curso/pronombres_personales_curso.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Pronombres Personales</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Qué forma de "to be" usarías con "He"?', options: ['am', 'are', 'is'], answer: 'is' },
                            { type: 'true-false', question: '¿"We are" significa "Nosotros estamos"?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "I _____ a teacher."', answer: 'am' },
                            { type: 'multiple-choice', question: '¿Cuál es la traducción correcta de "You are busy"?', options: ['Tú eres ocupado', 'Tú estás ocupado', 'Él está ocupado'], answer: 'Tú estás ocupado' },
                            { type: 'true-false', question: '¿El verbo "to be" significa "tener"?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "They _____ in the park."', answer: 'are' }
                        ]
                    },
                    'articulos': {
                        title: 'Artículos A / An y The',
                        content: `
                            <h3 class="text-2xl font-semibold">Artículos Indefinidos: A y An</h3>
                            <p>Se usan para hablar de algo no específico, como un sustantivo genérico. Significan "un", "una".</p>
                            <ul class="list-disc list-inside space-y-2 mt-2">
                                <li><strong>A:</strong> Se usa antes de palabras que empiezan con sonido de consonante. Ejemplo: a car, a book.</li>
                                <li><strong>An:</strong> Se usa antes de palabras que empiezan con sonido de vocal. Ejemplo: an apple, an hour (la 'h' no suena).</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Artículo Definido: The</h3>
                            <p>Se usa para hablar de algo específico o conocido. Significa "el", "la", "los", "las".</p>
                            <ul class="list-disc list-inside space-y-2 mt-2">
                                <li>Se usa tanto con sustantivos singulares como plurales. Ejemplo: the sun, the dogs.</li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1jhGo_egJ2-VJjMBrsTZWKuxGfu-riLyG" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/pronombres_personales_curso/pronombres_personales_curso.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Pronombres Personales</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Qué artículo usarías para "orange"?', options: ['A', 'An', 'The'], answer: 'An' },
                            { type: 'true-false', question: '¿"A" se usa para sustantivos que empiezan con vocal?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "I need to buy _____ new computer." (genérico)', answer: 'a' },
                            { type: 'multiple-choice', question: '¿Qué artículo usarías para "university"? (sonido de "you")', options: ['An', 'A', 'The'], answer: 'A' },
                            { type: 'true-false', question: '¿"The" se usa para sustantivos específicos?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "I saw _____ moon." (específico)', answer: 'the' }
                        ]
                    }
                }
            },
            'modulo-4-adjetivos-adverbios': {
                title: 'Módulo 4: Adjetivos y Adverbios',
                description: 'Aprende a describir personas y acciones usando adjetivos y adverbios, y a comparar con comparativos y superlativos.',
                color: 'bg-teal-500',
                media: {
                    image: 'https://images.unsplash.com/photo-1549057442-5f6531557007?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8fGVufDB8fHx8fA%3D%3D',
                },
                lessons: {
                    'adverbios-manera': {
                        title: 'Adverbios de Manera',
                        content: `
                            <h3 class="text-2xl font-semibold">Concepto</h3>
                            <p>Los adverbios de manera describen cómo se realiza una acción. Muchos se forman añadiendo **-ly** al adjetivo.</p>
                            <h3 class="text-2xl font-semibold mt-4">Ejemplos clave</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>Quick</strong> (rápido) -> <strong>quickly</strong> (rápidamente)</li>
                                <li><strong>Slow</strong> (lento) -> <strong>slowly</strong> (lentamente)</li>
                                <li><strong>Careful</strong> (cuidadoso) -> <strong>carefully</strong> (cuidadosamente)</li>
                                <li><strong>Happy</strong> (feliz) -> <strong>happily</strong> (felizmente)</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Excepción</h3>
                            <p>Algunos adverbios son irregulares. Por ejemplo, el adverbio de **"good"** es **"well"**.</p>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1jhGo_egJ2-VJjMBrsTZWKuxGfu-riLyG" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/pronombres_personales_curso/pronombres_personales_curso.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Pronombres Personales</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Cómo se forma el adverbio de "slow"?', options: ['slowly', 'slowful', 'slowlyy'], answer: 'slowly' },
                            { type: 'true-false', question: '¿El adverbio de "good" es "goodly"?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "He sings so _____." (beautifully)', answer: 'beautifully' },
                            { type: 'multiple-choice', question: '¿Cuál es el adverbio de "quick"?', options: ['quicker', 'quickly', 'quickest'], answer: 'quickly' },
                            { type: 'true-false', question: '¿Los adverbios describen acciones?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "She writes very _____." (carefully)', answer: 'carefully' }
                        ]
                    },
                    'comparativos-superlativos': {
                        title: 'Comparativos y Superlativos',
                        content: `
                            <h3 class="text-2xl font-semibold">Comparativos</h3>
                            <p>Se usan para comparar dos cosas.</p>
                            <ul class="list-disc list-inside space-y-2 mt-2">
                                <li><strong>Adjetivos cortos:</strong> Añade **-er**. Ejemplo: small -> smaller.</li>
                                <li><strong>Adjetivos largos:</strong> Usa **more**. Ejemplo: beautiful -> more beautiful.</li>
                                <li>Usa **"than"** después del adjetivo. Ejemplo: He is **taller than** me.</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Superlativos</h3>
                            <p>Se usan para comparar tres o más cosas, indicando el más extremo.</p>
                            <ul class="list-disc list-inside space-y-2 mt-2">
                                <li><strong>Adjetivos cortos:</strong> Añade **-est**. Ejemplo: small -> smallest.</li>
                                <li><strong>Adjetivos largos:</strong> Usa **most**. Ejemplo: beautiful -> most beautiful.</li>
                                <li>Usa **"the"** antes del adjetivo. Ejemplo: She is **the smartest** student.</li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1jhGo_egJ2-VJjMBrsTZWKuxGfu-riLyG" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/pronombres_personales_curso/pronombres_personales_curso.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Pronombres Personales</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Qué forma comparativa usarías para "big"?', options: ['bigger', 'more big', 'the biggest'], answer: 'bigger' },
                            { type: 'true-false', question: '¿El superlativo de "expensive" es "expensivest"?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "This is _____ book I have ever read." (interesting, superlativo)', answer: 'the most interesting' },
                            { type: 'multiple-choice', question: '¿Cuál es el comparativo de "good"? (irregular)', options: ['gooder', 'better', 'more good'], answer: 'better' },
                            { type: 'true-false', question: '¿"The" se usa con los superlativos?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "He is _____ than his brother." (tall)', answer: 'taller' }
                        ]
                    }
                }
            },
            'modulo-5-verbos-tiempos': {
                title: 'Módulo 5: Verbos y Tiempos Verbales',
                description: 'Domina los verbos en presente simple y continuo, y aprende a formar oraciones negativas e interrogativas.',
                color: 'bg-purple-600',
                media: {
                    image: 'https://images.unsplash.com/photo-1549057442-5f6531557007?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8fGVufDB8fHx8fA%3D%3D',
                },
                lessons: {
                    'presente-simple': {
                        title: 'Presente Simple (Simple Present)',
                        content: `
                            <h3 class="text-2xl font-semibold">Concepto</h3>
                            <p>Se usa para hablar de rutinas, hechos generales y cosas que suceden regularmente.</p>
                            <h3 class="text-2xl font-semibold mt-4">Regla principal</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>Para **He, She, It**, se añade una **-s** al final del verbo.</li>
                                <li>Para **I, You, We, They**, el verbo se queda igual.</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Ejemplos clave</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>I **eat** breakfast every day.</li>
                                <li>She **eats** breakfast every day.</li>
                                <li>We **play** football.</li>
                                <li>He **plays** football.</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Forma negativa e interrogativa</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>Se usa **do** o **does** (para he/she/it).</li>
                                <li>Negativo: I **do not** eat. / She **does not** eat.</li>
                                <li>Interrogativo: **Do** you eat? / **Does** she eat?</li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1jhGo_egJ2-VJjMBrsTZWKuxGfu-riLyG" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/pronombres_personales_curso/pronombres_personales_curso.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Pronombres Personales</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Cómo se diría "Él juega" en inglés?', options: ['He play', 'He plays', 'He playing'], answer: 'He plays' },
                            { type: 'true-false', question: '¿Para "We" se añade una -s al verbo en presente simple?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "They _____ to school every day." (go)', answer: 'go' },
                            { type: 'multiple-choice', question: '¿Cuál es la forma negativa de "She reads"?', options: ['She not read', 'She does not read', 'She do not read'], answer: 'She does not read' },
                            { type: 'true-false', question: '¿Se usa "do" para hacer preguntas con "They"?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "_____ he work here?" (Do o Does)', answer: 'Does' }
                        ]
                    },
                    'presente-continuo': {
                        title: 'Presente Continuo (Present Continuous)',
                        content: `
                            <h3 class="text-2xl font-semibold">Concepto</h3>
                            <p>Se usa para hablar de acciones que están sucediendo en el momento en que se habla.</p>
                            <h3 class="text-2xl font-semibold mt-4">Regla principal</h3>
                            <p>Se forma con el verbo "to be" + el verbo principal con la terminación **-ing**.</p>
                            <h3 class="text-2xl font-semibold mt-4">Estructura</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>Sujeto + <strong>to be</strong> (am/is/are) + Verbo-**ing**</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Ejemplos clave</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>I **am eating** lunch. (Estoy comiendo el almuerzo.)</li>
                                <li>She **is studying** right now. (Ella está estudiando ahora mismo.)</li>
                                <li>They **are playing** outside. (Ellos están jugando afuera.)</li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1jhGo_egJ2-VJjMBrsTZWKuxGfu-riLyG" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/pronombres_personales_curso/pronombres_personales_curso.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Pronombres Personales</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Cómo se diría "Ella está durmiendo" en inglés?', options: ['She sleeping', 'She is sleeping', 'She sleeps'], answer: 'She is sleeping' },
                            { type: 'true-false', question: '¿El presente continuo se usa para rutinas diarias?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "We _____ a movie now." (watch)', answer: 'are watching' },
                            { type: 'multiple-choice', question: '¿Cuál es la forma correcta de "It is rain"?', options: ['It is rain', 'It raining', 'It is raining'], answer: 'It is raining' },
                            { type: 'true-false', question: '¿El verbo auxiliar del presente continuo es "do"?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "You _____ on the phone." (talk)', answer: 'are talking' }
                        ]
                    }
                }
            },
            'modulo-6-frases-expresiones': {
                title: 'Módulo 6: Frases y Expresiones',
                description: 'Aprende las frases más comunes para el día a día, hacer preguntas, dar direcciones y hablar sobre el clima.',
                color: 'bg-orange-500',
                media: {
                    image: 'https://images.unsplash.com/photo-1549057442-5f6531557007?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8fGVufDB8fHx8fA%3D%3D',
                },
                lessons: {
                    'frases-comunes': {
                        title: 'Frases Comunes',
                        content: `
                            <h3 class="text-2xl font-semibold">Expresiones diarias</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>How are you?</strong> ¿Cómo estás?</li>
                                <li><strong>I'm fine, thanks.</strong> Estoy bien, gracias.</li>
                                <li><strong>Excuse me.</strong> Disculpe.</li>
                                <li><strong>I'm sorry.</strong> Lo siento.</li>
                                <li><strong>Thank you.</strong> Gracias.</li>
                                <li><strong>You're welcome.</strong> De nada.</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Preguntas comunes</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>What's your name?</strong> ¿Cuál es tu nombre?</li>
                                <li><strong>Where are you from?</strong> ¿De dónde eres?</li>
                                <li><strong>How old are you?</strong> ¿Cuántos años tienes?</li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1jhGo_egJ2-VJjMBrsTZWKuxGfu-riLyG" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/pronombres_personales_curso/pronombres_personales_curso.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Pronombres Personales</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Cuál es la respuesta correcta para "Thank you"?', options: ['Excuse me', 'You\'re welcome', 'I\'m sorry'], answer: 'You\'re welcome' },
                            { type: 'true-false', question: '¿"Where are you from?" pregunta por la edad?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa: "I am hungry, but I am _____." (full)', answer: 'full' },
                            { type: 'multiple-choice', question: '¿Cómo se dice "Lo siento" en inglés?', options: ['I am happy', 'I\'m sorry', 'I don\'t know'], answer: 'I\'m sorry' },
                            { type: 'true-false', question: '¿"What\'s your name?" pregunta por el nombre?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa: "How _____ are you?"', answer: 'old' }
                        ]
                    }
                }
            },
            'modulo-7-futuro-simple-y-condicionales': {
                title: 'Módulo 7: Futuro Simple y Condicionales',
                description: 'Expresa planes y posibilidades futuras usando el futuro simple y las oraciones condicionales.',
                color: 'bg-teal-500',
                media: {
                    image: 'https://images.unsplash.com/photo-1549057442-5f6531557007?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8fGVufDB8fHx8fA%3D%3D',
                },
                lessons: {
                    'futuro-will': {
                        title: 'Futuro Simple con "Will"',
                        content: `
                            <h3 class="text-2xl font-semibold">Concepto</h3>
                            <p>El futuro simple con **"will"** se usa para hablar de predicciones, decisiones espontáneas o promesas sobre el futuro.</p>
                            <h3 class="text-2xl font-semibold mt-4">Regla principal</h3>
                            <p>Se forma con **will + verbo en su forma base** (sin "to"). Se usa la misma forma para todos los pronombres.</p>
                            <h3 class="text-2xl font-semibold mt-4">Ejemplos clave</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>I **will travel** to the beach next week. (Viajaré a la playa la próxima semana.)</li>
                                <li>She **will call** you later. (Ella te llamará más tarde.)</li>
                                <li>They **will not study** for the exam. (Ellos no estudiarán para el examen.)</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Forma negativa e interrogativa</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>Negativo: **will not** (o la contracción **won't**). Ejemplo: He **will not** go.</li>
                                <li>Interrogativo: Se coloca **will** antes del sujeto. Ejemplo: **Will** you come?</li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1npwlJdfuw7jhpMgyVTcA144qVsBJyzen" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/saludos-y-despedidas/Saludos y Despedidas.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Lección</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Qué auxiliar se usa para el futuro simple?', options: ['do', 'will', 'is'], answer: 'will' },
                            { type: 'true-false', question: '¿"Will" se usa solo con el pronombre "I"?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "I _____ call you tomorrow." (will)', answer: 'will' },
                            { type: 'multiple-choice', question: '¿Cómo se diría "Ellos no vendrán"?', options: ['They not will come', 'They will not come', 'They don\'t come'], answer: 'They will not come' },
                            { type: 'true-false', question: '¿"Won\'t" es la contracción de "will not"?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "_____ she work on Friday?"', answer: 'Will' }
                        ]
                    },
                    'condicional-cero': {
                        title: 'Condicional Cero (Zero Conditional)',
                        content: `
                            <h3 class="text-2xl font-semibold">Concepto</h3>
                            <p>Se usa para hablar de hechos generales o científicos que siempre son verdaderos. Se utiliza para expresar una relación de causa y efecto.</p>
                            <h3 class="text-2xl font-semibold mt-4">Estructura</h3>
                            <p>**If + Presente Simple, Presente Simple**</p>
                            <h3 class="text-2xl font-semibold mt-4">Ejemplos clave</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>If you **heat** water to 100°C, it **boils**. (Si calientas agua a 100°C, hierve.)</li>
                                <li>If it **rains**, the ground **gets** wet. (Si llueve, el suelo se moja.)</li>
                                <li>The ice **melts** if you **heat** it. (El hielo se derrite si lo calientas.)</li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1npwlJdfuw7jhpMgyVTcA144qVsBJyzen" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/saludos-y-despedidas/Saludos y Despedidas.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Lección</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Qué tiempo verbal se usa en ambas partes del condicional cero?', options: ['Futuro', 'Pasado', 'Presente Simple'], answer: 'Presente Simple' },
                            { type: 'true-false', question: '¿El condicional cero se usa para hablar de eventos que suceden de vez en cuando?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "If you _____ a light, it turns on." (turn on)', answer: 'turn on' },
                            { type: 'multiple-choice', question: '¿Cuál de estas oraciones es un ejemplo del condicional cero?', options: ['If I study, I will pass.', 'If I studied, I would pass.', 'If you freeze water, it becomes ice.'], answer: 'If you freeze water, it becomes ice.' },
                            { type: 'true-false', question: '¿El orden de las cláusulas puede ser invertido sin cambiar el significado?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "If I _____ late, I miss the bus." (be)', answer: 'am' }
                        ]
                    }
                }
            },

            'modulo-8-vocabulario-esencial': {
                title: 'Módulo 8: Vocabulario Esencial',
                description: 'Amplía tu vocabulario con palabras para el trabajo, la familia, la comida y la vida cotidiana.',
                color: 'bg-pink-500',
                media: {
                    image: 'https://images.unsplash.com/photo-1549057442-5f6531557007?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8fGVufDB8fHx8fA%3D%3D',
                },
                lessons: {
                    'vocabulario-comida': {
                        title: 'Vocabulario de Comida',
                        content: `
                            <h3 class="text-2xl font-semibold">Alimentos Básicos</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>Apple:</strong> Manzana</li>
                                <li><strong>Bread:</strong> Pan</li>
                                <li><strong>Cheese:</strong> Queso</li>
                                <li><strong>Chicken:</strong> Pollo</li>
                                <li><strong>Egg:</strong> Huevo</li>
                                <li><strong>Fish:</strong> Pescado</li>
                                <li><strong>Milk:</strong> Leche</li>
                                <li><strong>Water:</strong> Agua</li>
                                <li><strong>Sugar:</strong> Azúcar</li>
                                <li><strong>Salt:</strong> Sal</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Frases útiles</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>What would you like to eat? (¿Qué te gustaría comer?)</li>
                                <li>I am hungry. (Tengo hambre.)</li>
                                <li>Let's go to the restaurant. (Vamos al restaurante.)</li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1npwlJdfuw7jhpMgyVTcA144qVsBJyzen" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/saludos-y-despedidas/Saludos y Despedidas.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Lección</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Cuál es la palabra en inglés para "pan"?', options: ['Bread', 'Milk', 'Water'], answer: 'Bread' },
                            { type: 'true-false', question: '¿"Apple" significa "manzana"?', answer: true },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "I want a glass of _____."', answer: 'water' },
                            { type: 'multiple-choice', question: '¿Cómo se dice "pollo" en inglés?', options: ['Fish', 'Chicken', 'Egg'], answer: 'Chicken' },
                            { type: 'true-false', question: '¿"I am hungry" significa "tengo sed"?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "Please pass the _____."', answer: 'salt' }
                        ]
                    },
                    'vocabulario-familia': {
                        title: 'Vocabulario de la Familia',
                        content: `
                            <h3 class="text-2xl font-semibold">Miembros de la Familia</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>Mother:</strong> Madre</li>
                                <li><strong>Father:</strong> Padre</li>
                                <li><strong>Sister:</strong> Hermana</li>
                                <li><strong>Brother:</strong> Hermano</li>
                                <li><strong>Grandmother:</strong> Abuela</li>
                                <li><strong>Grandfather:</strong> Abuelo</li>
                                <li><strong>Aunt:</strong> Tía</li>
                                <li><strong>Uncle:</strong> Tío</li>
                                <li><strong>Cousin:</strong> Primo/a</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Frases útiles</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>This is my family. (Esta es mi familia.)</li>
                                <li>I have one brother. (Tengo un hermano.)</li>
                                <li>My mother is a teacher. (Mi madre es una maestra.)</li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1npwlJdfuw7jhpMgyVTcA144qVsBJyzen" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/saludos-y-despedidas/Saludos y Despedidas.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Lección</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Cuál es la palabra en inglés para "madre"?', options: ['Father', 'Sister', 'Mother'], answer: 'Mother' },
                            { type: 'true-false', question: '¿"Cousin" significa "tío"?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "My _____ is my dad\'s brother."', answer: 'uncle' },
                            { type: 'multiple-choice', question: '¿Cómo se dice "hermana" en inglés?', options: ['Brother', 'Sister', 'Cousin'], answer: 'Sister' },
                            { type: 'true-false', question: '¿"Grandfather" significa "abuela"?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "This is my _____." (prima)', answer: 'cousin' }
                        ]
                    },
                    'vocabulario-objetos': {
                        title: 'Vocabulario de Objetos Cotidianos',
                        content: `
                            <h3 class="text-2xl font-semibold">Objetos en la Casa</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li><strong>Table:</strong> Mesa</li>
                                <li><strong>Chair:</strong> Silla</li>
                                <li><strong>Book:</strong> Libro</li>
                                <li><strong>Pen:</strong> Bolígrafo</li>
                                <li><strong>Phone:</strong> Teléfono</li>
                                <li><strong>Computer:</strong> Computadora</li>
                                <li><strong>Door:</strong> Puerta</li>
                                <li><strong>Window:</strong> Ventana</li>
                            </ul>
                            <h3 class="text-2xl font-semibold mt-4">Frases útiles</h3>
                            <ul class="list-disc list-inside space-y-2">
                                <li>Where is my book? (¿Dónde está mi libro?)</li>
                                <li>The window is open. (La ventana está abierta.)</li>
                                <li>Can I borrow your pen? (¿Me prestas tu bolígrafo?)</li>
                            </ul>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <a href="https://drive.google.com/uc?export=download&id=1npwlJdfuw7jhpMgyVTcA144qVsBJyzen" target="_blank" class="bg-blue-500 text-white py-2 px-6 rounded-full font-semibold hover:bg-blue-600 transition duration-300 transform hover:scale-105 inline-flex items-center">
                                    <i class="fas fa-download mr-2"></i> Descargar lección
                                </a>
                                <audio controls class="w-full md:w-1/2">
                                    <source src="https://archive.org/download/saludos-y-despedidas/Saludos y Despedidas.mp3" type="audio/mpeg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <p class="text-sm mt-2 text-gray-500">Audio: Lección</p>
                            </div>
                        `,
                        quiz: [
                            { type: 'multiple-choice', question: '¿Cuál es la palabra en inglés para "silla"?', options: ['Table', 'Chair', 'Book'], answer: 'Chair' },
                            { type: 'true-false', question: '¿"Pen" significa "lápiz"?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "I need to open the _____."', answer: 'door' },
                            { type: 'multiple-choice', question: '¿Cómo se dice "computadora" en inglés?', options: ['Phone', 'Book', 'Computer'], answer: 'Computer' },
                            { type: 'true-false', question: '¿"Window" significa "puerta"?', answer: false },
                            { type: 'fill-in-the-blank', question: 'Completa la frase: "The _____ is in the kitchen."', answer: 'table' }
                        ]
                    }
                }
            },

            'modulo-3-juego': {
                title: 'Módulo 3: Juego de Memoria',
                description: '¡Pon a prueba tu memoria y vocabulario en este divertido juego de emparejar!',
                color: 'bg-indigo-600',
                game: 'matching-game'
            }
        };

        const blockedModules = [
            'modulo-2-sustantivos-adjetivos',
            'modulo-3-juego'
        ];

        let currentModule = null;
        let currentLesson = null;
        let quizQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let timerId = null;
        let timeLeft = 900; // 10 minutes in seconds

        const mainMenu = document.getElementById('main-menu');
        const moduleList = document.getElementById('module-list');
        const moduleView = document.getElementById('module-view');
        const moduleTitle = document.getElementById('module-title');
        const moduleDescription = document.getElementById('module-description');
        const moduleMedia = document.getElementById('module-media');
        const lessonList = document.getElementById('lesson-list');
        const lessonTemplate = document.getElementById('lesson-template');
        const quizTemplate = document.getElementById('quiz-template');
        const quizQuestionsContainer = document.getElementById('quiz-questions');
        const feedbackMessageElement = document.getElementById('feedback-message');
        const progressText = document.getElementById('progress-text');
        const progressBar = document.getElementById('progress-bar');
        const quizResults = document.getElementById('quiz-results');
        const scoreText = document.getElementById('score-text');
        const timerElement = document.getElementById('timer');
        const blockedModal = document.getElementById('blocked-modal');
        const adminButton = document.getElementById('admin-button');
        const adminModal = document.getElementById('admin-modal');
        const unlockButton = document.getElementById('unlock-button');
        const adminPasswordInput = document.getElementById('admin-password-input');
        const adminMessage = document.getElementById('admin-message');
        const matchingGameTemplate = document.getElementById('matching-game-template');
        const shareButton = document.getElementById('share-button');

        let isAllModulesUnlocked = false;
        let userProgress = {};

        function saveProgress() {
            localStorage.setItem('userProgress', JSON.stringify(userProgress));
            localStorage.setItem('isAllModulesUnlocked', isAllModulesUnlocked);
        }

        function loadProgress() {
            const savedProgress = localStorage.getItem('userProgress');
            if (savedProgress) {
                userProgress = JSON.parse(savedProgress);
            }
            isAllModulesUnlocked = localStorage.getItem('isAllModulesUnlocked') === 'true';
        }

        function toggleModuleBlocked(moduleId, isBlocked) {
            const moduleCard = document.querySelector(`.module-card[data-id="${moduleId}"]`);
            if (moduleCard) {
                if (isBlocked) {
                    moduleCard.classList.add('opacity-50', 'cursor-not-allowed');
                    moduleCard.querySelector('.block-overlay').classList.remove('hidden');
                } else {
                    moduleCard.classList.remove('opacity-50', 'cursor-not-allowed');
                    moduleCard.querySelector('.block-overlay').classList.add('hidden');
                }
            }
        }

        function showMainMenu() {
            hideAllViews();
            mainMenu.classList.remove('hidden');
            if (isAllModulesUnlocked) {
                adminButton.classList.add('hidden');
            } else {
                adminButton.classList.remove('hidden');
            }
            renderModules();
        }

        function renderModules() {
            moduleList.innerHTML = '';
            const moduleKeys = Object.keys(modules);
            moduleKeys.forEach(key => {
                const module = modules[key];
                const moduleCard = document.createElement('div');
                moduleCard.className = `relative module-card p-6 text-center transform transition duration-300 hover:scale-105 hover:shadow-xl cursor-pointer ${module.color || 'bg-gray-100'}`;
                moduleCard.dataset.id = key;

                const isBlocked = !isAllModulesUnlocked && blockedModules.includes(key);
                const isDarkBackground = ['bg-indigo-600', 'bg-teal-500', 'bg-green-600', 'bg-red-500', 'bg-orange-500', 'bg-pink-500', 'bg-purple-600'].includes(module.color);
                
                moduleCard.innerHTML = `
                    <div class="space-y-4">
                        <i class="fas fa-book-open text-4xl ${isDarkBackground ? 'text-white' : 'text-gray-600'}"></i>
                        <h3 class="text-2xl font-bold ${isDarkBackground ? 'text-white' : 'text-gray-800'}">${module.title}</h3>
                        <p class="text-gray-600 ${isDarkBackground ? 'text-white' : 'text-gray-600'}">${module.description}</p>
                    </div>
                    ${isBlocked ? '<div class="absolute inset-0 bg-white bg-opacity-70 flex items-center justify-center rounded-lg block-overlay"><i class="fas fa-lock text-4xl text-red-500"></i></div>' : ''}
                `;

                if (isBlocked) {
                    moduleCard.onclick = () => showBlockedMessage();
                } else {
                    moduleCard.onclick = () => showModule(key);
                }

                moduleList.appendChild(moduleCard);
            });
        }

        function showModule(moduleId) {
            currentModule = moduleId;
            const module = modules[currentModule];

            if (module.game) {
                hideAllViews();
                matchingGameTemplate.classList.remove('hidden');
                setupMatchingGame();
                return;
            }
            
            hideAllViews();
            moduleView.classList.remove('hidden');
            moduleTitle.textContent = module.title;
            moduleDescription.textContent = module.description;
            renderModuleMedia(module.media);
            renderLessons(module.lessons);
        }
        
        function renderMedia(media, container) {
            container.innerHTML = '';
            if (media && media.document) {
                if (Array.isArray(media.document)) {
                    media.document.forEach(doc => {
                        const docLink = document.createElement('a');
                        docLink.href = doc.url;
                        docLink.className = 'mr-2 bg-gray-200 text-gray-800 py-2 px-4 rounded-full inline-flex items-center hover:bg-gray-300 transition duration-300';
                        docLink.innerHTML = `<i class="fas fa-file-pdf mr-2"></i> ${doc.name}`;
                        docLink.target = '_blank';
                        container.appendChild(docLink);
                    });
                } else {
                    const docLink = document.createElement('a');
                    docLink.href = media.document.url;
                    docLink.className = 'mr-2 bg-orange-200 text-orange-800 py-2 px-4 rounded-full inline-flex items-center hover:bg-orange-300 transition duration-300';
                    docLink.innerHTML = `<i class="fas fa-file-pdf mr-2"></i> ${media.document.name}`;
                    docLink.target = '_blank';
                    container.appendChild(docLink);
                }
            }
            if (media && media.audio) {
                const audioLink = document.createElement('a');
                audioLink.href = media.audio.url;
                audioLink.className = 'ml-4 bg-gray-200 text-gray-800 py-2 px-4 rounded-full inline-flex items-center hover:bg-gray-300 transition duration-300';
                audioLink.innerHTML = `<i class="fas fa-volume-up mr-2"></i> ${media.audio.name}`;
                audioLink.target = '_blank';
                container.appendChild(audioLink);
            }
        }

        function renderModuleMedia(media) {
            moduleMedia.innerHTML = '';
            if (media && media.image) {
                const img = document.createElement('img');
                img.src = media.image;
                img.alt = media.title;
                img.className = 'w-full max-h-64 object-cover rounded-lg mb-4';
                moduleMedia.appendChild(img);
            }
            renderMedia(media, moduleMedia);
        }

        function renderLessons(lessons) {
            lessonList.innerHTML = '';
            const lessonColors = ['bg-blue-500', 'bg-green-500', 'bg-yellow-500', 'bg-red-500', 'bg-purple-500', 'bg-teal-500'];
            const lessonKeys = Object.keys(lessons);
            lessonKeys.forEach((key, i) => {
                const lesson = lessons[key];
                const lessonCard = document.createElement('div');
                const color = lessonColors[i % lessonColors.length];
                lessonCard.className = `card p-6 text-center transform transition duration-300 hover:scale-105 hover:shadow-xl cursor-pointer ${color} text-white`;
                lessonCard.innerHTML = `
                    <i class="fas fa-graduation-cap text-3xl text-white mb-2"></i>
                    <h4 class="text-xl font-semibold">${lesson.title}</h4>
                `;
                lessonCard.onclick = () => showLesson(key);
                lessonList.appendChild(lessonCard);
            });
        }

        function showLesson(lessonId) {
            currentLesson = lessonId;
            const lesson = modules[currentModule].lessons[currentLesson];
            hideAllViews();
            const lessonView = lessonTemplate.cloneNode(true);
            lessonView.id = 'lesson-view';
            lessonView.classList.remove('hidden');
            lessonView.querySelector('#lesson-title').textContent = lesson.title;
            lessonView.querySelector('#lesson-content').innerHTML = lesson.content;
            
            const quizButton = lessonView.querySelector('#show-quiz-button');
            if (quizButton) {
                if (lesson.quiz) {
                    quizButton.onclick = () => showQuiz();
                    quizButton.classList.remove('hidden');
                } else {
                    quizButton.classList.add('hidden');
                }
            }
            
            const backButton = lessonView.querySelector('#back-to-modules-button');
            if (backButton) {
                backButton.onclick = () => showModule(currentModule);
            }
            
            const lessonMediaContainer = lessonView.querySelector('#lesson-media-container');
            renderMedia(lesson.media, lessonMediaContainer);

            document.getElementById('app-container').appendChild(lessonView);
        }

        function showQuiz() {
            const quiz = modules[currentModule].lessons[currentLesson].quiz;
            if (!quiz) {
                alert('No hay quiz para esta lección.');
                return;
            }
            quizQuestions = quiz;
            currentQuestionIndex = 0;
            score = 0;
            
            hideAllViews();
            
            // Se clona la plantilla del quiz para crear una nueva instancia
            const quizView = quizTemplate.cloneNode(true);
            quizView.id = 'quiz-view';
            quizView.classList.remove('hidden');

            // Se obtienen los elementos DENTRO de la vista clonada
            const backButton = quizView.querySelector('#back-to-lesson-button');
            const quizTitle = quizView.querySelector('#quiz-title');

            if (backButton) {
                backButton.onclick = () => showLesson(currentLesson);
            }
            if (quizTitle) {
                quizTitle.textContent = `Quiz: ${modules[currentModule].lessons[currentLesson].title}`;
            }

            document.getElementById('app-container').appendChild(quizView);
            
            // Se pasa la vista del quiz como argumento a las siguientes funciones
            startTimer(quizView);
            renderQuestion(quizView);
        }

        function renderQuestion(quizView) {
            if (!quizView) return; // Validación para asegurar que la vista existe
            
            const questionData = quizQuestions[currentQuestionIndex];
            
            // Se obtienen los elementos DENTRO de la vista del quiz
            const quizQuestionsContainer = quizView.querySelector('#quiz-questions');
            const feedbackMessageElement = quizView.querySelector('#feedback-message');
            
            if (!quizQuestionsContainer || !feedbackMessageElement) return;

            quizQuestionsContainer.innerHTML = '';
            feedbackMessageElement.textContent = ''; // Limpiar el feedback anterior

            const questionElement = document.createElement('div');
            questionElement.className = 'bg-white p-6 rounded-lg shadow-md space-y-4';
            questionElement.innerHTML = `<p class="text-lg font-medium">${currentQuestionIndex + 1}. ${questionData.question}</p>`;
            
            const optionsContainer = document.createElement('div');
            optionsContainer.className = 'space-y-2';

            if (questionData.type === 'multiple-choice') {
                questionData.options.forEach(option => {
                    const optionButton = document.createElement('button');
                    optionButton.textContent = option;
                    optionButton.className = 'quiz-option w-full text-left py-3 px-4 bg-gray-100 rounded-lg border-2 border-transparent hover:border-blue-500';
                    optionButton.onclick = () => checkAnswer(option, questionData.answer, optionButton, quizView);
                    optionsContainer.appendChild(optionButton);
                });
            } else if (questionData.type === 'true-false') {
                const trueButton = document.createElement('button');
                trueButton.textContent = 'Verdadero';
                trueButton.className = 'quiz-option w-full text-left py-3 px-4 bg-gray-100 rounded-lg border-2 border-transparent hover:border-blue-500';
                trueButton.onclick = () => checkAnswer(true, questionData.answer, trueButton, quizView);
                optionsContainer.appendChild(trueButton);
                
                const falseButton = document.createElement('button');
                falseButton.textContent = 'Falso';
                falseButton.className = 'quiz-option w-full text-left py-3 px-4 bg-gray-100 rounded-lg border-2 border-transparent hover:border-blue-500';
                falseButton.onclick = () => checkAnswer(false, questionData.answer, falseButton, quizView);
                optionsContainer.appendChild(falseButton);
            } else if (questionData.type === 'fill-in-the-blank') {
                const input = document.createElement('input');
                input.type = 'text';
                input.className = 'w-full py-2 px-4 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500';
                input.placeholder = 'Escribe tu respuesta aquí...';
                const submitButton = document.createElement('button');
                submitButton.textContent = 'Enviar Respuesta';
                submitButton.className = 'bg-blue-500 text-white py-2 px-4 rounded-full mt-2 hover:bg-blue-600 transition duration-300';
                submitButton.onclick = () => checkAnswer(input.value.toLowerCase().trim(), questionData.answer.toLowerCase().trim(), submitButton, quizView);
                optionsContainer.appendChild(input);
                optionsContainer.appendChild(submitButton);
            }
            
            questionElement.appendChild(optionsContainer);
            quizQuestionsContainer.appendChild(questionElement);
            updateProgressBar(quizView);
        }

        function checkAnswer(userAnswer, correctAnswer, button, quizView) {
            if (!quizView) return;

            const feedbackMessageElement = quizView.querySelector('#feedback-message');
            const isCorrect = String(userAnswer).toLowerCase().trim() === String(correctAnswer).toLowerCase().trim();
            
            const quizQuestionsContainer = quizView.querySelector('#quiz-questions');
            if (!quizQuestionsContainer) return;

            Array.from(quizQuestionsContainer.querySelectorAll('.quiz-option, button[type="submit"]')).forEach(btn => {
                btn.disabled = true;
                btn.classList.add('cursor-not-allowed', 'opacity-50');
            });

            if (isCorrect) {
                score++;
                if (button) {
                    button.classList.add('bg-green-500', 'text-white');
                    button.classList.remove('bg-gray-100', 'hover:border-blue-500');
                }
                if (feedbackMessageElement) {
                    feedbackMessageElement.textContent = '¡Genial! ¡Respuesta correcta!';
                    feedbackMessageElement.className = 'mt-4 text-center text-lg font-bold text-green-600';
                }
            } else {
                if (button) {
                    button.classList.add('bg-red-500', 'text-white');
                    button.classList.remove('bg-gray-100', 'hover:border-blue-500');
                }
                if (feedbackMessageElement) {
                    feedbackMessageElement.innerHTML = `¡Incorrecto! La respuesta correcta era: <span class="text-blue-600">${correctAnswer}</span>`;
                    feedbackMessageElement.className = 'mt-4 text-center text-lg font-bold text-red-600';
                }
            }
            
            if (!isCorrect) {
                const correctButton = Array.from(quizQuestionsContainer.querySelectorAll('.quiz-option')).find(btn => String(btn.textContent).toLowerCase().trim() === String(correctAnswer).toLowerCase().trim());
                if (correctButton) {
                    correctButton.classList.add('bg-green-500', 'text-white');
                }
            }

            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < quizQuestions.length) {
                    renderQuestion(quizView);
                } else {
                    endQuiz(quizView);
                }
            }, 1500);
        }

        function updateProgressBar(quizView) {
            if (!quizView) return;
            const progressText = quizView.querySelector('#progress-text');
            const progressBar = quizView.querySelector('#progress-bar');
            
            const progressPercentage = (currentQuestionIndex / quizQuestions.length) * 100;
            if (progressBar) progressBar.style.width = `${progressPercentage}%`;
            if (progressText) progressText.textContent = `${currentQuestionIndex}/${quizQuestions.length}`;
        }
        
        function startTimer(quizView) {
            if (timerId) clearInterval(timerId);
            timeLeft = 900;
            const timerElement = quizView.querySelector('#timer');
            timerId = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                if (timerElement) {
                  timerElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }
                if (timeLeft <= 0) {
                    clearInterval(timerId);
                    endQuiz(quizView);
                } else {
                    timeLeft--;
                }
            }, 1000);
        }

        function endQuiz(quizView) {
            clearInterval(timerId);
            if (quizView) {
                const quizQuestionsContainer = quizView.querySelector('#quiz-questions');
                const progressContainer = quizView.querySelector('#progress-container');
                const timerContainer = quizView.querySelector('#timer-container');
                const feedbackMessage = quizView.querySelector('#feedback-message');
                const quizResults = quizView.querySelector('#quiz-results');
                const scoreText = quizView.querySelector('#score-text');
                
                if (quizQuestionsContainer) quizQuestionsContainer.classList.add('hidden');
                if (progressContainer) progressContainer.classList.add('hidden');
                if (timerContainer) timerContainer.classList.add('hidden');
                if (feedbackMessage) feedbackMessage.classList.add('hidden');
                if (quizResults) quizResults.classList.remove('hidden');
                
                const percentage = (score / quizQuestions.length) * 100;
                if (scoreText) scoreText.innerHTML = `Tu puntuación es: <span class="font-bold text-blue-600">${score} / ${quizQuestions.length}</span> (${percentage.toFixed(0)}%)`;

                if (!userProgress[currentModule]) {
                    userProgress[currentModule] = {};
                }
                userProgress[currentModule][currentLesson] = {
                    score: score,
                    total: quizQuestions.length,
                    passed: percentage >= 70
                };
                saveProgress();
            }
        }

        function hideAllViews() {
            const views = [mainMenu, moduleView, lessonTemplate, quizTemplate, matchingGameTemplate];
            views.forEach(view => view.classList.add('hidden'));
            const dynamicViews = document.querySelectorAll('#lesson-view, #quiz-view');
            dynamicViews.forEach(view => view.remove());
        }

        function showBlockedMessage() {
            blockedModal.classList.remove('hidden');
        }

        function hideBlockedMessage() {
            blockedModal.classList.add('hidden');
        }

        function showAdminModal() {
            adminModal.classList.remove('hidden');
        }

        function hideAdminModal() {
            adminModal.classList.add('hidden');
        }

        function unlockModules() {
            const password = adminPasswordInput.value;
            database.ref('passwords/adminPassword').once('value')
                .then(snapshot => {
                    const storedPassword = snapshot.val();
                    
                    if (password === storedPassword) {
                        isAllModulesUnlocked = true;
                        saveProgress();
                        hideAdminModal();
                        showMainMenu();
                        adminMessage.classList.add('hidden');
                    } else {
                        adminMessage.textContent = 'Contraseña incorrecta. Inténtalo de nuevo.';
                        adminMessage.className = 'text-red-500 text-sm mt-2';
                        adminMessage.classList.remove('hidden');
                    }
                })
                .catch(error => {
                    console.error("Error al leer la contraseña de Firebase:", error);
                    adminMessage.textContent = 'Ocurrió un error. Inténtalo más tarde.';
                    adminMessage.className = 'text-red-500 text-sm mt-2';
                    adminMessage.classList.remove('hidden');
                });
        }
        
        function shareCourse() {
            const courseUrl = window.location.href;
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(courseUrl).then(() => {
                    alert('¡Enlace del curso copiado al portapapeles!');
                }).catch(err => {
                    console.error('Error al copiar el enlace:', err);
                    alert('No se pudo copiar el enlace. Por favor, cópialo manualmente: ' + courseUrl);
                });
            } else {
                alert('Tu navegador no soporta la función de copiado. Por favor, copia el enlace manualmente: ' + courseUrl);
            }
        }

        // Memory Game Logic
        let hasFlippedCard = false;
        let lockBoard = false;
        let firstCard, secondCard;
        let pairsFound = 0;

        const pairs = [
            'Hello', 'Hello', 'Goodbye', 'Goodbye',
            'Book', 'Book', 'Computer', 'Computer',
            'Student', 'Student', 'Teacher', 'Teacher',
            'House', 'House', 'Car', 'Car',
            'Dog', 'Dog', 'Cat', 'Cat'
        ];

        function shuffle(array) {
            array.sort(() => Math.random() - 0.5);
        }

        function createCards() {
            shuffle(pairs);
            const cardContainer = document.getElementById('card-container');
            cardContainer.innerHTML = '';
            pairs.forEach(pair => {
                const card = document.createElement('div');
                card.className = 'card-game';
                card.dataset.pair = pair;
                card.innerHTML = `
                    <div class="card-inner">
                        <div class="card-front"><i class="fas fa-question text-3xl"></i></div>
                        <div class="card-back">${pair}</div>
                    </div>
                `;
                card.addEventListener('click', flipCard);
                cardContainer.appendChild(card);
            });
            pairsFound = 0;
        }

        function flipCard() {
            if (lockBoard) return;
            if (this === firstCard) return;

            this.classList.add('flipped');
            if (!hasFlippedCard) {
                hasFlippedCard = true;
                firstCard = this;
            } else {
                secondCard = this;
                checkForMatch();
            }
        }

        function checkForMatch() {
            let isMatch = firstCard.dataset.pair === secondCard.dataset.pair;
            isMatch ? disableCards() : unflipCards();
        }

        function disableCards() {
            firstCard.removeEventListener('click', flipCard);
            secondCard.removeEventListener('click', flipCard);
            firstCard.style.boxShadow = '0 0 10px #4ade80';
            secondCard.style.boxShadow = '0 0 10px #4ade80';
            pairsFound++;
            resetBoard();

            if (pairsFound === pairs.length / 2) {
                setTimeout(() => {
                    const winMessage = document.createElement('div');
                    winMessage.className = 'text-center mt-6 text-2xl font-bold text-green-700';
                    winMessage.textContent = '¡Felicidades, has encontrado todas las parejas!';
                    document.getElementById('card-container').appendChild(winMessage);
                }, 500);
            }
        }

        function unflipCards() {
            lockBoard = true;
            setTimeout(() => {
                firstCard.classList.remove('flipped');
                secondCard.classList.remove('flipped');
                resetBoard();
            }, 1000);
        }

        function resetBoard() {
            [hasFlippedCard, lockBoard] = [false, false];
            [firstCard, secondCard] = [null, null];
        }

        document.addEventListener('DOMContentLoaded', createCards);
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
            showMainMenu();
            unlockButton.addEventListener('click', unlockModules);
            adminPasswordInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    unlockModules();
                }
            });
            adminButton.addEventListener('click', showAdminModal);
            shareButton.addEventListener('click', shareCourse);
        });
    </script>
</body>
</html>
